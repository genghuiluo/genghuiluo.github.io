---
layout: post
title: 高性能MySQL_2_基准测试
date: 2017-04-11 18:14:37 +0800
categories: mysql
---

sysbench, a great MySQL benchmark testing tool

[MySQL 101: Monitor Disk I/O with pt-diskstats](https://www.percona.com/blog/2014/09/04/mysql-101-monitor-disk-io-with-pt-diskstats/)

基于MySQL默认配置的测试没有什么意义，因为默认配置是基于消耗很少的极小应用的

自动化基准测试，可以是一个Makefile文件或者一组脚本(shell/PHP/Perl...)

收集数据: https://github.com/genghuiluo/legacy/blob/master/mysql/collect_sample.sh

抽取数据: https://github.com/genghuiluo/legacy/blob/master/mysql/analyze_sample.sh
``` shell
$./analyze_sample.sh 5-sec-status-2017-04-11_05-status
#ts date time load QPS
1491901265 2017-04-11 17:01:05 0.04 0.00
1491901270 2017-04-11 17:01:10 0.04 1.80
1491901275 2017-04-11 17:01:15 0.03 2.40
1491901280 2017-04-11 17:01:20 0.11 1.80
1491901285 2017-04-11 17:01:25 0.10 1.80
1491901290 2017-04-11 17:01:30 0.09 1.20
1491901295 2017-04-11 17:01:35 0.09 1.80
1491901300 2017-04-11 17:01:40 0.08 2.00
1491901305 2017-04-11 17:01:45 0.07 1.60
1491901310 2017-04-11 17:01:50 0.07 1.80
1491901315 2017-04-11 17:01:55 0.06 2.80
1491901320 2017-04-11 17:02:00 0.06 1.20
```

绘图:(gnuplot / R）
``` shell
$gnuplot
...
gnuplot> plot "mysql/qps-per-5-sec" using 5 w lines title "QPS"
```
![]({{ site.url }}/assets/gnuplot_mysql.jpg)
